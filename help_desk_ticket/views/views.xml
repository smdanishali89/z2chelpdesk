<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="team_wizard_view_form" model="ir.ui.view"> 
        <field name="name">team_wizard_view_form</field> 
        <field name="model">ecube.team.wizard</field> 
        <field name="arch" type="xml"> 
            <form string="Form" >
                <sheet> 
                    <group name="group_top"> 
                        <group name="group_left">
                            <field name="team_name_link_invisible" options="{'no_create': True,'no_open': True,'no_edit': True}" invisible="1"/>
                           
                            <field name="team_name_link" options="{'no_create': True,'no_open': True,'no_edit': True}" readonly="1"/>
                            <field name="remarks_required" invisible="1"/>
                            <field name="remarks" attrs="{'required':[('remarks_required','=',True)]}"/>
                        </group>
                        <group name="group_right">
                            <field name="user_id" domain="[('id', 'in', team_users)]" options="{'no_create': True,'no_open': True,'no_edit': True}"/>
                            
                            <field name="team_users" widget="many2many_tags" options="{'no_create': True,'no_open': True,'no_edit': True}" invisible="1"/>
                        </group>
                    </group>
                </sheet>
                <footer>
                    <button name = "save_close" string = "Save And Close" type = "object"/>
                </footer>
            </form> 
        </field> 
    </record>


    <record id="group_helpdesk_view" model="res.groups">
        <field name="name">View Access</field>
         <field name="implied_ids" eval="[(4, ref('helpdesk.group_helpdesk_user'))]"/>
        <field name="category_id" ref="base.module_category_services_helpdesk"/>
    </record>


    <record id="group_helpdesk_helpdesk_admin" model="res.groups">
        <field name="name">Helpdesk Admin</field>
        <field name="implied_ids" eval="[(4, ref('helpdesk.group_helpdesk_manager'))]"/>
        <field name="category_id" ref="base.module_category_services_helpdesk"/>
    </record>

    <data>

        <record id="help_desk_team_extention_readonly_0" model="ir.ui.view">
            <field name="name">help_desk_team_extention_readonly_0</field>
            <field name="model">ecube.team.wizard</field>
            <field name="inherit_id" ref="team_wizard_view_form" />
            <field name="groups_id" eval="[(6, 0, [ref('helpdesk.group_helpdesk_manager')])]" />                
            <field name="arch" type="xml">                                   
                <field name="team_name_link" position="attributes">
                   <attribute name="readonly">0</attribute>                   
                </field>
            </field>
        </record> 
        
        <!-- Extended view = helpdesk team form (HELPDESK Team creation form) -->
        <record id="helpdesk_team_ext" model="ir.ui.view">
            <field name="name">helpdesk_team_ext</field>
            <field name="model">helpdesk.team</field>
            <field name="inherit_id" ref="helpdesk.helpdesk_team_view_form" />
            <field name="arch" type="xml">
                <xpath expr="//sheet//div//div[3]//div[2]//field[@name='visibility_member_ids']" position="after">
                    <div>.</div>
                    <div>.</div>
                    <div>
                        <group string=' '>
                            <!-- <label for="ticket_type">Ticket type: </label> -->
                            <field name="view_member_ids" widget="many2many_tags" />
                            <field name="team_name" readonly="1"/>
                            <field name="default_team"/>
                            <field name="from_email_template"/>
                            <field name="team_name_link" invisible="1"/>
                            <field name="ticket_type" widget="many2many_tags" />
                        </group>
                    </div>
                    <div>.</div>
                    <div>
                        <label for="ticket_tag">Ticket tag: </label>
                        <field name="ticket_tag" widget="many2many_tags" />
                    </div>
                </xpath>
            </field>
        </record>
        
        <!-- Extended view = All tickets (create ticket forms) -->
        <record id="helpdesk_type_ext" model="ir.ui.view">
            <field name="name">helpdesk_type_ext</field>
            <field name="model">helpdesk.ticket</field>
            <field name="inherit_id" ref="helpdesk.helpdesk_ticket_view_form" />
            <field name="arch" type="xml">
                
                <xpath expr="//field[@name='ticket_type_id']" position="replace">
                    <field name="reason_of_rejection" string="Reason For Rejection"/>
                    <field name="reason_of_rejection_required" invisible="1"/>
                    <field name="ticket_type_id" domain="[('id', 'in', ticket_type)]" required="0" options="{'no_create': True ,'no_open': True}"/>
                    
                    <field name="ticket_type" widget="many2many_tags" nolabel="1" invisible="1" />
                </xpath>

                <xpath expr="//button[@name='assign_ticket_to_self']" position="replace">
                    <button name="chaneg_team" type="object" string="Change Team/User" class="oe_highlight" />
                </xpath>

                <xpath expr="//field[@name='tag_ids']" position="replace">
                    <field name="tag_ids" domain="[('id', 'in',ticket_tag)]" widget="many2many_tags" options="{'color_field': 'color','no_create': True ,'no_open': True}" />
                    <field name="ticket_tag" widget="many2many_tags" nolabel="1" invisible="1" />
                    <field name="remarks_required" invisible="1" />
                    <field name="remarks" attrs="{'required':[('remarks_required','=',True)]}" readonly="1"/>
                </xpath>
                
                
                <xpath expr="//field[@name='team_id']" position="replace">
                    <field name="team_id" options="{'no_create': True ,'no_open': True}" readonly="1"/>
                    <field name="body" invisible="1"/>
                </xpath>
                
                
                <xpath expr="//field[@name='partner_id']" position="before">
                    <field name="create_date" readonly="1" string="Creation Date"/>
                    <field name="close_date" readonly="1" string="Close Date"/>
                    <field name="close_hours" readonly="1" invisible="1" />
                </xpath>


                <xpath expr="//field[@name='user_id']" position="attributes">
                     <attribute name="options">{'no_open':True}</attribute> 
                </xpath>

                <xpath expr="//field[@name='user_id']" position="attributes">
                     <attribute name="string">Assigned To</attribute> 
                </xpath>

                <xpath expr="//field[@name='user_id']" position="attributes">
                     <attribute name ="readonly">1</attribute>       
                </xpath>

                <xpath expr="//field[@name='partner_id']" position="attributes">
                     <attribute name ="readonly">1</attribute>       
                </xpath>


                <xpath expr="//field[@name='partner_id']" position="attributes">
                     <attribute name="options">{'no_open':True}</attribute> 
                </xpath>

                <xpath expr="//field[@name='partner_email']" position="attributes">
                     <attribute name ="readonly">1</attribute>       
                </xpath>


            </field>
        </record>

        <record id="helpdesk_ticket_tree_ext" model="ir.ui.view">
            <field name="name">helpdesk_ticket_tree_ext</field>
            <field name="model">helpdesk.ticket</field>
            <field name="inherit_id" ref="helpdesk.helpdesk_tickets_view_tree" />
            <field name="arch" type="xml">
                
                <xpath expr="//field[@name='stage_id']" position="before" >
                    <field name="create_date" optional="hide" string="Creation Date"/>
                    <field name="close_date" optional="hide" string="Close Date"/>
                </xpath>
                
                <xpath expr="//field[@name='user_id']" position="replace" >
                    <field name="user_id" optional="show" widget="many2one_avatar_user" string="Assigned To"/>
                </xpath>

            </field>
        </record> 

        <!-- Extended view = All tickets (create ticket forms) -->
        <record id="helpdesk_stage_ext" model="ir.ui.view">
            <field name="name">helpdesk_stage_ext</field>
            <field name="model">helpdesk.stage</field>
            <field name="inherit_id" ref="helpdesk.helpdesk_stage_view_form" />
            <field name="arch" type="xml">
                
                <xpath expr="//field[@name='is_close']" position="after">
                    <field name="re_open_stage"/>
                    <field name="rejected_stage"/>
                    <field name="in_progress"/>
                    <field name="complete_stage"/>
                </xpath>

            </field>
        </record>
    </data>

</odoo>