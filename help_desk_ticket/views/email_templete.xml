<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- ${object.team_id.display_name} "Helpdesk" <helpdesk@z2climited.com> -->

        <record id="new_ticket_request_email_template_ext" model="mail.template">
            <field name="name">Ticket: Reception Acknowledgment Ecube</field>

            <field name="model_id" ref="helpdesk.model_helpdesk_ticket"/>
            <field name="subject">${object.display_name}</field>
            <field name="email_from">${object.team_id.display_name} "Helpdesk" "helpdesk@z2climited.com"></field>
            <field name="email_to">${(object.partner_email if not object.sudo().partner_id.email or object.sudo().partner_id.email != object.partner_email else '') | safe}</field>
            <field name="partner_to">${object.partner_id.id if object.sudo().partner_id.email and object.sudo().partner_id.email == object.partner_email else ''}</field>
            <field name="body_html" type="xml">
                <div>
                    Dear ${object.sudo().partner_id.name or 'Madam/Sir'},<br /><br />
                    Your request
                    % if object.get_portal_url():
                    <a href="/my/ticket/${object.id}/${object.access_token}">${object.name}</a>
                    % endif
                    has been received and is being reviewed by our ${object.team_id.name or ''} team.
                    Your ticket number is ${object.id}.<br /><br />

                    <div style="text-align: center; margin: 16px 0px 16px 0px;">
                        <a style="background-color: #875A7B; padding: 8px 16px 8px 16px; text-decoration: none; color: #fff; border-radius: 5px; font-size:13px;" href="${object.get_portal_url()}">View the ticket</a><br/>
                    </div>

                    To add additional comments, please reply to this email.<br/><br/>

                    Kind regards,<br/><br/>
                    ${object.team_id.name or 'Helpdesk'} Team.
                </div>
            </field>
            <field name="lang">${object.partner_id.lang or object.user_id.lang or user.lang}</field>
            <field name="auto_delete" eval="False"/>
        </record>

        <record id="inprogress_ticket_request_email_template_ext" model="mail.template">
            <field name="name">Ticket: Inprogress Ecube</field>
            <field name="model_id" ref="helpdesk.model_helpdesk_ticket"/>
            <field name="subject">${object.display_name}</field>
                <!-- ${object.team_id.display_name} "Helpdesk" <helpdesk@z2climited.com> -->
            <field name="email_from">${object.team_id.display_name} "Helpdesk" "helpdesk@z2climited.com"></field>
            <field name="email_to">${(object.partner_email if not object.sudo().partner_id.email or object.sudo().partner_id.email != object.partner_email else '') | safe}</field>
            <field name="partner_to">${object.partner_id.id if object.sudo().partner_id.email and object.sudo().partner_id.email == object.partner_email else ''}</field>
            <field name="body_html" type="xml">
                <div>
                    Dear ${object.sudo().partner_id.name or 'Madam/Sir'},<br /><br />
                    This is to inform you that your ticket number ${object.id} "${object.name}" is in progress.<br /><br />

                    Thank you for your cooperation.<br/><br/>

                    Kind regards,<br/><br/>
                    ${object.team_id.name or 'Helpdesk'} Team.
                </div>
            </field>
            <field name="lang">${object.partner_id.lang or object.user_id.lang or user.lang}</field>
            <field name="auto_delete" eval="False"/>
        </record>

        <record id="rejected_ticket_request_email_template_ext" model="mail.template">
            <field name="name">Ticket: Rejected Ecube</field>
            <field name="model_id" ref="helpdesk.model_helpdesk_ticket"/>
            <field name="subject">${object.display_name}</field>
            <field name="email_from">${object.team_id.display_name} "Helpdesk" "helpdesk@z2climited.com"></field>
            <field name="email_to">${(object.partner_email if not object.sudo().partner_id.email or object.sudo().partner_id.email != object.partner_email else '') | safe}</field>
            <field name="partner_to">${object.partner_id.id if object.sudo().partner_id.email and object.sudo().partner_id.email == object.partner_email else ''}</field>
            <field name="body_html" type="xml">
                <div>
                    Dear ${object.sudo().partner_id.name or 'Madam/Sir'},<br /><br />
                    We regret to inform you that your ticket number ${object.id} "${object.name}"  has been rejected.<br /><br />

                    Reason: "${object.reason_of_rejection}".<br/><br/>
                    Thank you for your cooperation.<br/>

                    Kind regards,<br/>
                    ${object.team_id.name or 'Helpdesk'} Team.
                </div>
            </field>
            <field name="lang">${object.partner_id.lang or object.user_id.lang or user.lang}</field>
            <field name="auto_delete" eval="False"/>
        </record>


    <record id="rating_ticket_request_email_template_ext_ecube" model="mail.template">
        <field name="name">Ticket: Rating Request Ecube Updated (requires rating enabled on team)</field>
        <field name="model_id" ref="helpdesk.model_helpdesk_ticket"/>
        <field name="subject">${object.company_id.name or object.user_id.company_id.name or 'Helpdesk'}: Service Rating Request</field>
        <field name="email_from">${object.rating_get_rated_partner_id().email_formatted | safe}</field>
        <field name="email_to">${(object.partner_email if not object.sudo().partner_id.email or object.sudo().partner_id.email != object.partner_email else '') | safe}</field>
        <field name="partner_to">${object.partner_id.id if object.sudo().partner_id.email and object.sudo().partner_id.email == object.partner_email else ''}</field>
        <field name="body_html" type="xml">
<div>
    % set access_token = object.rating_get_access_token()
    % set partner = object.rating_get_partner_id()
    <table border="0" cellpadding="0" cellspacing="0" style="width:100%; margin:0;">
    <tbody>
        <tr><td>
            % if partner.name:
                Hello Dear ${partner.name},<br/><br/>
            % else:
                Hello Dear,<br/><br/>
            % endif
            Please take a moment to rate our services related to your ticket number ${object.id} "${object.name}""
            % if object.rating_get_rated_partner_id().name:
                assigned to ${object.rating_get_rated_partner_id().name}.<br/>
            % else:
                .<br/>
            % endif
        </td></tr>
        <tr><td style="text-align: center;">
            <table border="0" cellpadding="0" cellspacing="0" summary="o_mail_notification" style="width:100%; margin: 32px 0px 32px 0px;">
                <tr><td style="font-size: 14px;">
                    <strong>Tell us how you feel about our service</strong><br/>
                    <span style="text-color: #888888">(click on one of these smileys)</span>
                </td></tr>
                <tr><td style="font-size: 14px;">
                    <table style="width:100%;text-align:center;">
                        <tr>
                            <td>
                                <a href="/rate/${access_token}/5">
                                    <img alt="Satisfied" src="/rating/static/src/img/rating_5.png" title="Satisfied"/>
                                </a>
                            </td>
                            <td>
                                <a href="/rate/${access_token}/3">
                                    <img alt="Not satisfied" src="/rating/static/src/img/rating_3.png" title="Not satisfied"/>
                                </a>
                            </td>

                            <td>
                                <a href="/rate/${access_token}/1">
                                    <img alt="REOPEN" src="/help_desk_ticket/static/src/img/reload.png" title="REOPEN"/>
                                    <h4>REOPEN</h4>
                                </a>
                            </td>
                        </tr>
                    </table>
                </td></tr>
            </table>
        </td></tr>
        <tr><td valign="top">
            We appreciate your feedback. It helps us to improve continuously.
            <br/>
            <br/>
            <strong>
                Note: If the task has not been completed, you can reopen your ticket by clicking on the “REOPEN”  button above.
            </strong>
        </td></tr>
    </tbody>
    </table>
</div>
        </field>
        <field name="lang">${object.partner_id.lang or object.user_id.lang or user.lang}</field>
        <field name="auto_delete" eval="True"/>
    </record>
    
    </data>
</odoo>
